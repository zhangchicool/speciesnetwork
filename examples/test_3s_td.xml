<?xml version="1.0" encoding="UTF-8"?>
<beast version="2.7" namespace="beast.base.core:beast.base.inference:beast.base.util:
                  beast.base.math:beast.base.evolution.alignment:beast.base.evolution.tree.coalescent:
                  beast.base.evolution.operator:beast.base.inference.operator:beast.base.evolution.sitemodel:
                  beast.base.evolution.substitutionmodel:beast.base.evolution.branchratemodel:
                  beast.base.evolution.likelihood:beastfx.app:
                  speciesnetwork:speciesnetwork.operators:speciesnetwork.simulator:
                  speciesnetwork.tools:speciesnetwork.utils">

    <data id="gene1" name="alignment">
        <sequence id="seq_1_1" taxon="a1" value="CTCTTGTGGACGCCATCGCCGATATTCCAGCAGACAGAAGGCAATGCAGAAGAACGCCGATAGTACAAGTACGGTTAAGCTTTATCTATTGGTCGCATGCGTCCGCTATTCTCTTCCGTACCGTTTCCCGCACGGCAATACCGTAGGAAAGTGAAAAAAAAGTTACACCCCTAACCGTGATCTGGCAACATTCTACTAGT"/>
        <sequence id="seq_1_2" taxon="a2" value="CTCTTGTGGACGCCATCGCCGATATTCCAGCAGACAGAGGGCAATGCAGAAGAACGCCGATAGTACAAGTCCGGTTAAGCTTTATCTACTGGTCGCATGCGTCCGCTATTCTCTTCCGTACCGGTTCCCACACGGCAATTCCGTTGGAAAGTGAAAAAAAAGATACACCCCTAACCGAGATCTGGCAACATTCTACTAGT"/>
        <sequence id="seq_1_3" taxon="b1" value="CTCTTGTGGACGGCATCGCCGATAGTCCATCGGTCAGGATGCAATGCAGAAGTACGACGATAGTATAAGTACGGTTAAGCTTTATCTACGGGTCGGATGCGTCTGCTATTATCTTCCGTAACGGTTACCGCTCGGCAATTTCGTTGGAAAGTGGAAATAAAGGTAGACCCTTAAGCGTGATTCGGCAAAATTCTACTCGT"/>
        <sequence id="seq_1_4" taxon="b2" value="CTATTGTGGACGCCATCGCCGATAGTCCAGCGGACAGAAGGCAATGCAGAAGAACGCCGATAGTACAAGTACGATTAAGCTCTATCTATTGGTCGCATGCCTCCGCTATTCTCTTGCGTACCGTTTCCCACAAGGCAATTCCGTTGGAAAGTGAAAAAAAAGATACACCCTTAACCGTGATTTGGCAACATTCTACTAGT"/>
        <sequence id="seq_1_5" taxon="c1" value="GTTTTGTCGACGGCATCGCCGAGATACCATCAGACACAAGGCAATGCAGAAGTAGGACGACAGTATAAATACGGTCAAGCTTTATCAATTGGTCGGATGCGTCCGCTATAATCTTCCGTACCCTTTACCACTCGCGAATTCGGTTGGAAAGTGGAAAAAAAGGTACACCCTTACGCGTGATTCGGCAAAATTCTATTCGT"/>
        <sequence id="seq_1_6" taxon="c2" value="CTCTGGTGGAGGCCATCCCCGATATTCCAGCGAACAGAAAGCAATGCAGAAGTACGACGTTAGTATAAGTACGGTTAAGATTTATCTATTGGTCGCATGCGTCCCCTATTCTGTTCCGTACCATTTCCGACACGGCAAACCCGTTGGAAAGTGGAAAAAAAGATAGAGCCTTAACCGTGATTTGGCAACATTCTACTAGT"/>
    </data>
    <data id="gene2" name="alignment">
        <sequence id="seq_2_1" taxon="a1" value="CACAGTGTCTATCCCAGTCCACTTCACCGCCAAATAGGCGTCGTAGAGTCGGGGATTGTTCGTTGACAAAGGAACTATTATAACATCCTCGGATCACAAGGTACATCGTATTCAATGGTCATTTAGTCGGAGCTGGCGACCTAGGGAGAAAAGCATTTTGAGGAAGCCCACCCACTAAATTCCTAACCAGTTATTGCATT"/>
        <sequence id="seq_2_2" taxon="b1" value="CATAGTGTCTATCCCAGTCCACTTCAGCGTCAAACAGGCGTAGTAGAGTCGGGGATGGTTCGTGGGCAAAGGAACTATTATGACGTCCTGGGATGCCAAGGTACCTTGTAGTCAATGGTCATTTAGTCGGAGCTGGCGACCTAGGGAGAAACGCATTGTGACGAAGCCCACCCGCTAACTTCCTAACCAGTTCTTGACCT"/>
        <sequence id="seq_2_3" taxon="b2" value="CACAGTGTCTATCCCAGTCCACTTCACCGTCAAATAGGCGTCGTAGAGTCGGGGATTGTTCGTTGACAAAGGAACTATTATAACTACCTCGGATCACAAGGTACATTGTATTCAATGGTCATTTAGTCGGAGCTGGCGACCTAGGGAGAAAAGCATTTTGAGGAAGCCCACCCACTAAATTCCTAACCAGTTATTGCATT"/>
        <sequence id="seq_2_4" taxon="b3" value="CACAGTGTCTATCCCAGTCCACTTCACCGTCAAATAGGCGTCGTAGAGTCGGGGATTGTTCGTTGACAAAGGAACTATTATAACTACCTCGGATCACAAGGTACATTGTATTCAATGGTCATTTAGTCGGAGCTGGCGACCTAGGGAGAAAAGCATTTTGAGGAAGCCCACCCACTAAATTCCTAACCAGTTATTGCATT"/>
        <sequence id="seq_2_5" taxon="b4" value="CATAGTGTCTATCCCAGTCCACTTCAGCGTCAAACAGGCGTAGTAGAGTCGGGGATGGTTCGTGGACAAAGGAACTATTATGAGGTCCTGGGAAGCCAAGGTACCTTATAGTCAATGGTCATTTAGTCGGAGCTGTCGACCTAGGGAGAAACGCATTGTGACGAAGCTCACCCGCTAACTTCCTAACCAGTTCTTGAACT"/>
        <sequence id="seq_2_6" taxon="c1" value="CATAGTGTCTATGCCAGTCAACTTCAACATCAAACAGGCGTCGAAGAGTCGGGGATTGTTCGTTGACAAAGGAACTATTATAACGTCATCGGATGGCAAGGTACGTTGTACTCAATCGTCATTTAGTCGGAGCTGGCGACCTAGCGAGAAAAGCAATTTGAGGAAGCCCACCCACTAAATTCCTAACCAGTTATTTCACT"/>
    </data>
    <data id="gene3" name="alignment">
        <sequence id="seq_3_1" taxon="a1" value="TATAGACGAACCGGCCTACTTTACAAGAACCCACTATCGGGAGATCTTCTCTGGAATTATTTGTTACCATCGTTAACATTGCGGGTCCTCCCTGGTCCCTAGCATATAACCCTTAGTTTAGTCATATTCGAAGCTCATCGGTTTAATACCGTTCCGTTACAAGCCTTCATACTACGGATCTCCTTTTTTGAAGCTTCTAT"/>
        <sequence id="seq_3_2" taxon="a2" value="GATAGACGAACCGGCCTACATTACAAGAATCCACTATACGGAGATCTTCTCTAGAATTATTCGTCACCATCGTGAACATTGCAGCTTCTCCCTGGTCCCTAGCATATAACCCTTAGTTTGGACATGTTCGGAGCTCATCGGTTTAATAGCGCTCCGTTACCAGCCTTCATACTACGGATCTCCTTTTTTGAAGCTTCTAT"/>
        <sequence id="seq_3_3" taxon="b1" value="GATCGACGAACCGGCCTACATTACAAGAACCCACTATAGGGAGATCTTCTCTGGAATTAATCGTTACCATCGTAAACATTGCAGCTCCTCCTTGGTCCCTAGCATATAACCCTTTGTTTAGACATATTCGAAGCTCATCGGTTTAATACGGTTCCGTTACCATCCTTCATACTACGGATCTCCTTTTTTGGAGGTTCTAT"/>
        <sequence id="seq_3_4" taxon="b2" value="GATCGACGAACCGGCCTACATTACAAGAACCCACTATAGGGAGATCTTCTCTGGAATTATTCGTTACCATCGTGAACATTGCAGCTCCTCCTTGGTCCCTAGCATATAACCCTTTGTTTAGACATATTCGAAGCTCATCGGTTTAATACGGTTCCGTTACCATCCTTCATACTACGGATCTCCTTTTTTGAAGGTTCTAT"/>
        <sequence id="seq_3_5" taxon="b3" value="CATAGACTGAGCGGCCTTCATTACAAGACCCCACTATCGGTAGATCTATTCTAGAATTATTCGTAACCATCGTGAACCTTGTAGCTCCTCCCTGGTCCCTAGCATATAACCCTTAGTTTAGACATATTCGAAGCTCATCGGTTTATCACCGTTCCGGTACCATCCTCCATCCTACGGATCTCCTATTTTGATACTTCTAT"/>
        <sequence id="seq_3_6" taxon="c1" value="GATAGACGGACCGGCCTACATTACAAGAACCCACTATCGGGAGATCTACTCTAGAATTATTCGTTACCATCGGGAACCTTGGAGCTCCTCCCTGGTCCCTAGCGTATAACCCTTAGTTTAGTCATATTCGAAGCTGATCGTTTTAACATCGTTCCGGTACCATTCTTCATACTACGGATCTCCTATTTTGAAGCTTCTAT"/>
        <sequence id="seq_3_7" taxon="c2" value="CTTCGACCGACCGGCCTACATGACACGAACCCACGATCGGTAGATCTACTCTAGAATTATTCGTAACTATCGTCAACCTTGCAGCTCCTCCCTGGTCCCTAGGATATAACCCTTAGTGTAGTCATATTCGAAGCTCATCACTTTAACACAGTTCCGGTACCATCCTCCATCCTACGGATCTCCTTTCTTGATGCTTCTAT"/>
    </data>

    <map name="Uniform">beast.base.inference.distribution.Uniform</map>
    <map name="Exponential">beast.base.inference.distribution.Exponential</map>
    <map name="LogNormal">beast.base.inference.distribution.LogNormalDistributionModel</map>
    <map name="Normal">beast.base.inference.distribution.Normal</map>
    <map name="Beta">beast.base.inference.distribution.Beta</map>
    <map name="Gamma">beast.base.inference.distribution.Gamma</map>
    <map name="LaplaceDistribution">beast.base.inference.distribution.LaplaceDistribution</map>
    <map name="InverseGamma">beast.base.inference.distribution.InverseGamma</map>
    <map name="OneOnX">beast.base.inference.distribution.OneOnX</map>
    <map name="prior">beast.base.inference.distribution.Prior</map>

    <init spec="beast.base.evolution.tree.TreeParser" id="newick:species" IsLabelledNewick="true" adjustTipHeights="false"
          newick="(((A:2.0,(B:1.0)#H1[&amp;gamma=0.3]:1.0)S1:3.0,(#H1:2.0,C:2.0)S2:2.0)R:3.0)"/>

    <!-- TODO
    <init spec="beast.base.evolution.tree.TreeParser" id="newick:gene1" IsLabelledNewick="true"
          newick="((((a1:0.015486335625819959,a2:0.015486335625819959):0.011550028197273198,b2:0.027036363823093157):0.05778693796023736,c2:0.08482330178333052):0.04695268241427415,(b1:0.07090676170149966,c1:0.07090676170149966):0.060869222496105005):0.0"/>
    <init spec="beast.base.evolution.tree.TreeParser" id="newick:gene2" IsLabelledNewick="true"
          newick="((a1:0.018500432803927776,(b2:0.00386346915702543,b3:0.00386346915702543):0.014636963646902345):0.04960144398638929,((b1:0.014153584463938329,b4:0.014153584463938329):0.05214326980030233,c1:0.06629685426424066):0.001805022526076408):0.0"/>
    <init spec="beast.base.evolution.tree.TreeParser" id="newick:gene3" IsLabelledNewick="true"
          newick="(((a1:0.03556624423508001,(a2:0.030002350069789695,(b1:0.007549115881014078,b2:0.007549115881014078):0.022453234188775616):0.0055638941652903125):0.02400410169340688,c1:0.05957034592848689):0.01620792796892636,(b3:0.06210020959853823,c2:0.06210020959853823):0.013678064298875019):0.0"/>
    -->

    <run id="mcmc" spec="MCMC" chainLength="2000000" storeEvery="10000">
        <state id="state">
            <stateNode id="network:species" spec="speciesnetwork.NetworkParser" tree="@newick:species">
            <!-- stateNode id="network:species" spec="speciesnetwork.Network" -->
                <trait id="date.t:species" spec="beast.base.evolution.tree.TraitSet" traitname="date-backward">
                    A=0,
                    B=0,
                    C=1.0
                    <taxa id="taxonSuperset" spec="TaxonSet">
                        <taxon id="A" spec="TaxonSet">
                            <taxon id="a1" spec="Taxon"/>
                            <taxon id="a2" spec="Taxon"/>
                        </taxon>
                        <taxon id="B" spec="TaxonSet">
                            <taxon id="b1" spec="Taxon"/>
                            <taxon id="b2" spec="Taxon"/>
                            <taxon id="b3" spec="Taxon"/>
                            <taxon id="b4" spec="Taxon"/>
                        </taxon>
                        <taxon id="C" spec="TaxonSet">
                            <taxon id="c1" spec="Taxon"/>
                            <taxon id="c2" spec="Taxon"/>
                        </taxon>
                    </taxa>
                </trait>
                <taxonset idref="taxonSuperset"/>
            </stateNode>
            <parameter id="popMean:species" lower="0.0" name="stateNode">1.0</parameter>
            <parameter id="originTime:species" lower="0.0" name="stateNode">10.0</parameter>
            <parameter id="netDivRate:species" lower="0.0" name="stateNode">0.1</parameter>
            <parameter id="turnOverRate:species" lower="0.0" upper="1.0" name="stateNode">0.5</parameter>
            <parameter id="hybridProp:species" lower="0.0" upper="1.0" name="stateNode">0.1</parameter>
            <parameter id="clockRate:gene" lower="0.0" name="stateNode">0.01</parameter>
            <stateNode id="tree:gene1" spec="speciesnetwork.EmbeddedTree" ploidy="2.0">
                <taxonset id="taxonset:gene1" spec="TaxonSet" alignment="@gene1"/>
            </stateNode>
            <stateNode id="tree:gene2" spec="speciesnetwork.EmbeddedTree" ploidy="2.0">
                <taxonset id="taxonset:gene2" spec="TaxonSet" alignment="@gene2"/>
            </stateNode>
            <stateNode id="tree:gene3" spec="speciesnetwork.EmbeddedTree" ploidy="2.0">
                <taxonset id="taxonset:gene3" spec="TaxonSet" alignment="@gene3"/>
            </stateNode>
        </state>

        <init id="SNI" spec="speciesnetwork.SpeciesNetworkInitializer" estimate="false" method="random" speciesNetwork="@network:species" origin="@originTime:species">
            <coalescentSimulator id="coalSim" spec="speciesnetwork.simulator.CoalescentSimulator" speciesNetwork="@network:species" popSizes="@popMean:species">
                <geneTree idref="tree:gene1"/>
                <geneTree idref="tree:gene2"/>
                <geneTree idref="tree:gene3"/>
            </coalescentSimulator>
            <rebuildEmbedding id="initEmbed" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="0.0">
                <geneTree idref="tree:gene1"/>
                <geneTree idref="tree:gene2"/>
                <geneTree idref="tree:gene3"/>
            </rebuildEmbedding>
        </init>

        <distribution id="posterior" spec="beast.base.inference.CompoundDistribution">
            <distribution id="coalescent" spec="speciesnetwork.MultispeciesCoalescent" speciesNetwork="@network:species">
                <geneTree idref="tree:gene1"/>
                <geneTree idref="tree:gene2"/>
                <geneTree idref="tree:gene3"/>
                <populationModel id="popModel" alpha="4.0" mean="@popMean:species" spec="speciesnetwork.ConstantPopIntegrated"/>
            </distribution>
            <distribution id="prior" spec="beast.base.inference.CompoundDistribution">
                <distribution id="networkPrior" spec="speciesnetwork.BirthDeathHybridization" network="@network:species" betaShape="2.0"
                              netDiversification="@netDivRate:species" turnOver="@turnOverRate:species" hybridProportion="@hybridProp:species"/>
                <prior id="popMeanPrior" name="distribution" x="@popMean:species">
                    <Gamma id="gammadistr.0" name="distr" alpha="3.0" beta="0.4"/>
                </prior>
                <prior id="originPrior" name="distribution" x="@originTime:species">
                    <Exponential id="exponential.0" name="distr" mean="10.0"/>
                </prior>
                <prior id="netDivPrior" name="distribution" x="@netDivRate:species">
                    <Exponential id="exponential.01" name="distr" mean="0.1"/>
                </prior>
                <prior id="turnOverPrior" name="distribution" x="@turnOverRate:species">
                    <Beta id="betadistr.01" name="distr" alpha="1.0" beta="1.0"/>
                </prior>
                <prior id="hybridPropPrior" name="distribution" x="@hybridProp:species">
                    <Beta id="betadistr.02" name="distr" alpha="1.0" beta="9.0"/>
                </prior>
                <prior id="clockRatePrior" name="distribution" x="@clockRate:gene">
                    <Uniform id="uniformdistr.0" name="distr" lower="0.0" upper="1.0"/>
                </prior>
            </distribution>
            <distribution id="likelihood" spec="beast.base.inference.CompoundDistribution">
                <distribution id="likelihood:gene1" data="@gene1" tree="@tree:gene1" spec="TreeLikelihood">
                    <siteModel id="siteModel:gene1" mutationRate="1.0" spec="SiteModel">
                        <substModel id="jc:gene1" spec="JukesCantor"/>
                    </siteModel>
                    <branchRateModel id="strictClock:gene" clock.rate="@clockRate:gene" spec="StrictClockModel"/>
                </distribution>
                <distribution id="likelihood:gene2" data="@gene2" tree="@tree:gene2" spec="TreeLikelihood">
                    <siteModel id="siteModel:gene2" mutationRate="1.0" spec="SiteModel">
                        <substModel id="jc:gene2" spec="JukesCantor"/>
                    </siteModel>
                    <branchRateModel idref="strictClock:gene"/>
                </distribution>
                <distribution id="likelihood:gene3" data="@gene3" tree="@tree:gene3" spec="TreeLikelihood">
                    <siteModel id="siteModel:gene3" mutationRate="1.0" spec="SiteModel">
                        <substModel id="jc:gene3" spec="JukesCantor"/>
                    </siteModel>
                    <branchRateModel idref="strictClock:gene"/>
                </distribution>
            </distribution>
        </distribution>

        <operator id="scaleAndEmbed:gene1" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="3.0">
            <geneTree idref="tree:gene1"/>
            <operator id="scale:gene1" spec="ScaleOperator" scaleFactor="0.5" tree="@tree:gene1" weight="0.0"/>
        </operator>
        <operator id="scaleRootAndEmbed:gene1" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="3.0">
            <geneTree idref="tree:gene1"/>
            <operator id="scaleRoot:gene1" spec="ScaleOperator" rootOnly="true" scaleFactor="0.5" tree="@tree:gene1" weight="0.0"/>
        </operator>
        <operator id="uniformAndEmbed:gene1" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="30.0">
            <geneTree idref="tree:gene1"/>
            <operator id="uniform:gene1" spec="Uniform" tree="@tree:gene1" weight="0.0"/>
        </operator>
        <operator id="subSlideAndEmbed:gene1" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="15.0">
            <geneTree idref="tree:gene1"/>
            <operator id="subSlide:gene1" spec="SubtreeSlide" tree="@tree:gene1" weight="0.0"/>
        </operator>
        <operator id="narrowAndEmbed:gene1" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="15.0">
            <geneTree idref="tree:gene1"/>
            <operator id="narrow:gene1" spec="Exchange" tree="@tree:gene1" weight="0.0"/>
        </operator>
        <operator id="wideAndEmbed:gene1" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="5.0">
            <geneTree idref="tree:gene1"/>
            <operator id="wide:gene1" spec="Exchange" isNarrow="false" tree="@tree:gene1" weight="0.0"/>
        </operator>
        <operator id="WilsonBaldingAndEmbed:gene1" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="5.0">
            <geneTree idref="tree:gene1"/>
            <operator id="WilsonBalding:gene1" spec="WilsonBalding" tree="@tree:gene1" weight="0.0"/>
        </operator>

        <operator id="scaleAndEmbed:gene2" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="3.0">
            <geneTree idref="tree:gene2"/>
            <operator id="scale:gene2" spec="ScaleOperator" scaleFactor="0.5" tree="@tree:gene2" weight="0.0"/>
        </operator>
        <operator id="scaleRootAndEmbed:gene2" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="3.0">
            <geneTree idref="tree:gene2"/>
            <operator id="scaleRoot:gene2" spec="ScaleOperator" rootOnly="true" scaleFactor="0.5" tree="@tree:gene2" weight="0.0"/>
        </operator>
        <operator id="uniformAndEmbed:gene2" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="30.0">
            <geneTree idref="tree:gene2"/>
            <operator id="uniform:gene2" spec="Uniform" tree="@tree:gene2" weight="0.0"/>
        </operator>
        <operator id="subSlideAndEmbed:gene2" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="15.0">
            <geneTree idref="tree:gene2"/>
            <operator id="subSlide:gene2" spec="SubtreeSlide" tree="@tree:gene2" weight="0.0"/>
        </operator>
        <operator id="narrowAndEmbed:gene2" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="15.0">
            <geneTree idref="tree:gene2"/>
            <operator id="narrow:gene2" spec="Exchange" tree="@tree:gene2" weight="0.0"/>
        </operator>
        <operator id="wideAndEmbed:gene2" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="5.0">
            <geneTree idref="tree:gene2"/>
            <operator id="wide:gene2" spec="Exchange" isNarrow="false" tree="@tree:gene2" weight="0.0"/>
        </operator>
        <operator id="WilsonBaldingAndEmbed:gene2" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="5.0">
            <geneTree idref="tree:gene2"/>
            <operator id="WilsonBalding:gene2" spec="WilsonBalding" tree="@tree:gene2" weight="0.0"/>
        </operator>

        <operator id="scaleAndEmbed:gene3" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="3.0">
            <geneTree idref="tree:gene3"/>
            <operator id="scale:gene3" spec="ScaleOperator" scaleFactor="0.5" tree="@tree:gene3" weight="0.0"/>
        </operator>
        <operator id="scaleRootAndEmbed:gene3" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="3.0">
            <geneTree idref="tree:gene3"/>
            <operator id="scaleRoot:gene3" spec="ScaleOperator" rootOnly="true" scaleFactor="0.5" tree="@tree:gene3" weight="0.0"/>
        </operator>
        <operator id="uniformAndEmbed:gene3" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="30.0">
            <geneTree idref="tree:gene3"/>
            <operator id="uniform:gene3" spec="Uniform" tree="@tree:gene3" weight="0.0"/>
        </operator>
        <operator id="subSlideAndEmbed:gene3" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="15.0">
            <geneTree idref="tree:gene3"/>
            <operator id="subSlide:gene3" spec="SubtreeSlide" tree="@tree:gene3" weight="0.0"/>
        </operator>
        <operator id="narrowAndEmbed:gene3" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="15.0">
            <geneTree idref="tree:gene3"/>
            <operator id="narrow:gene3" spec="Exchange" tree="@tree:gene3" weight="0.0"/>
        </operator>
        <operator id="wideAndEmbed:gene3" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="5.0">
            <geneTree idref="tree:gene3"/>
            <operator id="wide:gene3" spec="Exchange" isNarrow="false" tree="@tree:gene3" weight="0.0"/>
        </operator>
        <operator id="WilsonBaldingAndEmbed:gene3" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="5.0">
            <geneTree idref="tree:gene3"/>
            <operator id="WilsonBalding:gene3" spec="WilsonBalding" tree="@tree:gene3" weight="0.0"/>
        </operator>

        <operator id="clockScaler:gene" spec="ScaleOperator" parameter="@clockRate:gene" scaleFactor="0.5" weight="5.0"/>

        <operator id="popMeanScale:species" spec="ScaleOperator" parameter="@popMean:species" scaleFactor="0.5" weight="5.0"/>
        <operator id="divrRateScale:species" spec="ScaleOperator" parameter="@netDivRate:species" scaleFactor="0.5" weight="5.0"/>
        <operator id="turnOverScale:species" spec="ScaleOperator" parameter="@turnOverRate:species" scaleFactor="0.5" weight="5.0"/>
        <operator id="hybridPropScale:species" spec="ScaleOperator" parameter="@hybridProp:species" scaleFactor="0.5" weight="5.0"/>
        <operator id="gammaProbUniform:species" spec="speciesnetwork.operators.GammaProbUniform" speciesNetwork="@network:species" weight="20.0"/>
        <operator id="gammaProbRndWalk:species" spec="speciesnetwork.operators.GammaProbRndWalk" speciesNetwork="@network:species" weight="20.0"/>

        <operator id="originMultiplier:species" spec="speciesnetwork.operators.OriginMultiplier" speciesNetwork="@network:species" origin="@originTime:species" weight="5.0"/>
        <operator id="networkMultiplier:species" spec="speciesnetwork.operators.NetworkMultiplier" speciesNetwork="@network:species" origin="@originTime:species" weight="10.0">
            <geneTree idref="tree:gene1"/>
            <geneTree idref="tree:gene2"/>
            <geneTree idref="tree:gene3"/>
        </operator>
        <operator id="coordNodeUniform:species" spec="speciesnetwork.operators.CoordinatedNodeUniform" speciesNetwork="@network:species" weight="50.0">
            <geneTree idref="tree:gene1"/>
            <geneTree idref="tree:gene2"/>
            <geneTree idref="tree:gene3"/>
        </operator>
        <operator id="coordNodeSlider:species" spec="speciesnetwork.operators.CoordinatedNodeSlider" speciesNetwork="@network:species" isNormal="true" sigma="0.5" weight="50.0">
            <origin idref="originTime:species"/>
            <geneTree idref="tree:gene1"/>
            <geneTree idref="tree:gene2"/>
            <geneTree idref="tree:gene3"/>
        </operator>

        <operator id="coordRelocateBranch:species" spec="speciesnetwork.operators.CoordinatedRelocateBranch" speciesNetwork="@network:species" MSNC="@coalescent" weight="100.0">
            <coalescentSimulator idref="coalSim"/>
            <geneTree idref="tree:gene1"/>
            <geneTree idref="tree:gene2"/>
            <geneTree idref="tree:gene3"/>
        </operator>
        <operator id="coordAddReticulation:species" spec="speciesnetwork.operators.CoordinatedAddReticulation" speciesNetwork="@network:species" MSNC="@coalescent" weight="80.0">
            <coalescentSimulator idref="coalSim"/>
            <geneTree idref="tree:gene1"/>
            <geneTree idref="tree:gene2"/>
            <geneTree idref="tree:gene3"/>
        </operator>
        <operator id="coordDelReticulation:species" spec="speciesnetwork.operators.CoordinatedDeleteReticulation" speciesNetwork="@network:species" MSNC="@coalescent" weight="80.0">
            <coalescentSimulator idref="coalSim"/>
            <geneTree idref="tree:gene1"/>
            <geneTree idref="tree:gene2"/>
            <geneTree idref="tree:gene3"/>
        </operator>

        <operator id="relocateBranchAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="100.0">
            <geneTree idref="tree:gene1"/>
            <geneTree idref="tree:gene2"/>
            <geneTree idref="tree:gene3"/>
            <operator id="relocateBranch:species" spec="speciesnetwork.operators.RelocateBranch" speciesNetwork="@network:species" weight="0.0"/>
        </operator>
        <operator id="flipReticulationAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="15.0">
            <geneTree idref="tree:gene1"/>
            <geneTree idref="tree:gene2"/>
            <geneTree idref="tree:gene3"/>
            <operator id="flipReticulation:species" spec="speciesnetwork.operators.FlipReticulation" speciesNetwork="@network:species" weight="0.0"/>
        </operator>
        <operator id="addReticulationAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="80.0">
            <geneTree idref="tree:gene1"/>
            <geneTree idref="tree:gene2"/>
            <geneTree idref="tree:gene3"/>
            <operator id="addReticulation:species" spec="speciesnetwork.operators.AddReticulation" speciesNetwork="@network:species" weight="0.0"/>
        </operator>
        <operator id="deleteReticulationAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" weight="80.0">
            <geneTree idref="tree:gene1"/>
            <geneTree idref="tree:gene2"/>
            <geneTree idref="tree:gene3"/>
            <operator id="deleteReticulation:species" spec="speciesnetwork.operators.DeleteReticulation" speciesNetwork="@network:species" weight="0.0"/>
        </operator>

        <logger id="screenlog" logEvery="10000" model="@posterior">
            <log idref="posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
            <log idref="coalescent"/>
        </logger>
        <logger id="tracelog" fileName="test_3s.xml.trace.log" logEvery="1000" model="@posterior" sort="smart">
            <log idref="posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
            <log idref="coalescent"/>
            <log idref="netDivRate:species"/>
            <log idref="turnOverRate:species"/>
            <log idref="hybridProp:species"/>
            <log idref="originTime:species"/>
            <log idref="popMean:species"/>
            <log idref="clockRate:gene"/>
            <log id="height:species" speciesNetwork="@network:species" spec="speciesnetwork.utils.NetworkStatLogger"/>
            <log id="height:gene1" tree="@tree:gene1" spec="beast.base.evolution.tree.TreeStatLogger"/>
            <log id="height:gene2" tree="@tree:gene2" spec="beast.base.evolution.tree.TreeStatLogger"/>
            <log id="height:gene3" tree="@tree:gene3" spec="beast.base.evolution.tree.TreeStatLogger"/>
        </logger>
        <logger id="specieslog" fileName="test_3s.xml.species.trees" logEvery="1000" mode="tree">
            <log id="networkLogger:species" spec="speciesnetwork.utils.NetworkWithMetaDataLogger" speciesNetwork="@network:species"/>
        </logger>
        <logger id="backbonelog" fileName="test_3s.xml.backbone.trees" logEvery="1000" mode="tree">
            <log id="backboneLogger:species" spec="speciesnetwork.utils.BackboneTreeLogger" speciesNetwork="@network:species"/>
        </logger>
        <logger id="treelog:gene1" fileName="test_3s.xml.gene1.trees" logEvery="1000" mode="tree">
            <log id="treeLogger:gene1" tree="@tree:gene1" spec="beast.base.evolution.TreeWithMetaDataLogger"/>
        </logger>
        <logger id="treelog:gene2" fileName="test_3s.xml.gene2.trees" logEvery="1000" mode="tree">
            <log id="treeLogger:gene2" tree="@tree:gene2" spec="beast.base.evolution.TreeWithMetaDataLogger"/>
        </logger>
        <logger id="treelog:gene3" fileName="test_3s.xml.gene3.trees" logEvery="1000" mode="tree">
            <log id="treeLogger:gene3" tree="@tree:gene3" spec="beast.base.evolution.TreeWithMetaDataLogger"/>
        </logger>
    </run>
</beast>
